{"version":3,"sources":["logo.png","models/behavior.tsx","utils/time.tsx","utils/validators.tsx","models/pricing.tsx","PriceAnalyzer/matchers.tsx","PriceAnalyzer/analyzer.tsx","views/PriceAnalyzer.tsx","components/NumberInput.tsx","views/WeekPriceForm.tsx","components/Graph.tsx","views/WeekPriceHistoryGraph.tsx","redux/actions.tsx","views/EditPrice.tsx","views/ViewPrice.tsx","components/Dropdown.tsx","views/Nav.tsx","App.tsx","serviceWorker.ts","redux/reducers.tsx","PriceStore/localstorage.tsx","sagas.tsx","index.tsx"],"names":["module","exports","Pattern","daysOfWeek","submittableDays","slice","toKey","year","week","keyFromDayjs","time","isoWeekYear","isoWeek","NumberValidator","type","validate","v","Number","isNaN","NullableNumberValidator","validators","this","map","join","undefined","find","child","EmptyPriceRecord","buyPrice","prices","Array","length","WeekPriceRecord","obj","record","PriceRecord","TypeError","sanitize","p","decreasingMatcher","found","val","index","findIncreasingIndex","getRecommendation","pattern","Decreasing","Component","key","dayjs","behavior","filter","Unknown","recommendation","analyze","useSelector","state","weeklyPrices","NumberInput","props","input","rest","meta","TimeOfDay","SubmitButton","styled","button","TimeLabel","div","DayLabel","FormInput","day","Math","floor","timeOfDay","BuyPriceLabel","label","BuyPriceInput","StyledForm","form","am","pm","d","times","_","chain","zip","flatten","value","BuyPriceInputComponent","InputComponent","onSubmit","values","parseInt","rawPrices","pickBy","k","startsWith","mapKeys","mapValues","from","transformValues","render","handleSubmit","htmlFor","name","initialValue","priceRecord","component","aria-label","Container","canvasProps","width","height","Graph","canvas","chart","React","createRef","renderChart","ctx","current","getContext","labels","dataset","x","data","Chart","datasets","backgroundColor","borderColor","options","legend","display","scales","xAxes","ticks","callback","convertLabel","yAxes","beginAtZero","tooltips","callbacks","title","item","ref","domainToLabel","domain","min","max","WeeklyActionType","y","section","dispatch","useDispatch","WeekPriceForm","r","weekRecord","SAVE_WEEKLY_PRICES","payload","WeekPriceHistoryGraph","PriceAnalyzer","FloatContainer","FloatNav","ul","Dropdown","active","onClick","setState","className","children","NavButton","StyledNav","nav","NavLink","getProps","isCurrent","Nav","pricesByWeek","sorted","sortBy","reverse","now","to","start","valueOf","weekDiff","ceil","diff","format","formatWeekDiff","StyledHeader","header","StyledImg","img","Header","src","logo","alt","Home","InApp","App","basepath","path","EditPrice","ViewPrice","Boolean","window","location","hostname","match","initialWeeklyState","getKey","rootReducer","combineReducers","action","LOAD_WEEKLY_PRICES","keyBy","stringToModel","raw","parsed","JSON","parse","e","console","warn","recordKey","weekRaw","weekStr","substr","loadWeeklyPrices","watchSaveWeeklyPrices","rootSaga","priceStore","backing","localStorage","readIndex","indexRaw","getItem","Set","i","toString","writeIndex","keys","setItem","stringify","save","Promise","res","log","add","get","month","list","rej","LocalStorageWeeklyPrices","items","put","records","takeEvery","all","extend","composeEnhancers","composeWithDevTools","sagaMiddleware","createSagaMiddleware","store","createStore","applyMiddleware","run","ReactDOM","StrictMode","document","getElementById","navigator","serviceWorker","ready","then","registration","unregister","catch","error","message"],"mappings":"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","file":"static/js/main.10520c25.chunk.js","sourcesContent":["module.exports = \"data:image/png;base64,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\"","export enum Pattern {\r\n  Random = \"random\",\r\n  Decreasing = \"decreasing\",\r\n  SmallSpike = \"smallSpike\",\r\n  CamelHump = \"camel\",\r\n  InsufficientData = \"insufficientData\",\r\n  Unknown = \"unknown\",\r\n}\r\n\r\nexport interface Behavior {\r\n  pattern: Pattern,\r\n  recommendation: string,\r\n}\r\n","import { Dayjs } from 'dayjs'\r\n\r\nexport interface YearWeek {\r\n  year: number,\r\n  week: number,\r\n}\r\nexport const daysOfWeek = [\r\n  \"Sunday\",\r\n  \"Monday\",\r\n  \"Tuesday\",\r\n  \"Wednesday\",\r\n  \"Thursday\",\r\n  \"Friday\",\r\n  \"Saturday\",\r\n]\r\n\r\nexport const submittableDays = daysOfWeek.slice(1)\r\n\r\n\r\nfunction toKey(year: number, week: number): string {\r\n  return `${year}-${week}`\r\n}\r\n\r\nexport function keyFromYearWeek(yearWeek: YearWeek): string {\r\n  return toKey(yearWeek.year, yearWeek.week)\r\n}\r\n\r\nexport function keyFromDayjs(time: Dayjs): string {\r\n  return toKey(time.isoWeekYear(), time.isoWeek())\r\n}\r\n\r\nexport function yearWeekFromDayjs(time: Dayjs): YearWeek {\r\n  return {\r\n    year: time.isoWeekYear(),\r\n    week: time.isoWeek(),\r\n  }\r\n}\r\n","export type IValidator = {\r\n  type: any,\r\n  validate: (v: any) => boolean\r\n}\r\n\r\nexport const NullValidator: IValidator = {\r\n  type: null,\r\n  validate(v: any): v is null {\r\n    return v === null\r\n  }\r\n}\r\n\r\nexport const NumberValidator: IValidator = {\r\n  type: \"number\",\r\n  validate(v: any): v is number {\r\n    return !(Number.isNaN(Number(v)))\r\n  }\r\n}\r\n\r\nexport class CompoundValidator<T> implements IValidator {\r\n  type: any\r\n  validators: IValidator[]\r\n  constructor(validators: IValidator[]) {\r\n    this.validators = validators\r\n    this.type = validators.map(v => v.type).join(\" | \")\r\n  }\r\n\r\n  validate(v: any): v is T {\r\n    return this.validators.find(child => child.validate(v)) !== undefined\r\n  }\r\n}\r\n\r\nexport const NullableNumberValidator: IValidator = new CompoundValidator<null | number>([\r\n  NullValidator,\r\n  NumberValidator,\r\n])\r\n","import { submittableDays } from 'utils/time'\r\nimport { NullableNumberValidator, NumberValidator } from 'utils/validators'\r\n\r\nexport type MaybePrice = number | null\r\n\r\nexport interface IWeekPriceRecord {\r\n  year: number,\r\n  week: number,\r\n  record: IPriceRecord,\r\n}\r\n\r\nexport interface IPriceRecord {\r\n  buyPrice: MaybePrice,\r\n  prices: MaybePrice[],\r\n}\r\n\r\nexport const EmptyPriceRecord: IPriceRecord = {\r\n  buyPrice: null,\r\n  prices: new Array(submittableDays.length * 2),\r\n}\r\n\r\nexport class WeekPriceRecord implements IWeekPriceRecord {\r\n  week: number\r\n  year: number\r\n  record: IPriceRecord\r\n\r\n  constructor(obj: IWeekPriceRecord) {\r\n    this.week = obj.week\r\n    this.year = obj.year\r\n    this.record = new PriceRecord(obj.record)\r\n  }\r\n\r\n  static sanitize(obj: any): WeekPriceRecord {\r\n    if (!NumberValidator.validate(obj.year)) {\r\n      throw new TypeError(\"year is not a number\")\r\n    }\r\n    if (!NumberValidator.validate(obj.week)) {\r\n      throw new TypeError(\"week is not a number\")\r\n    }\r\n\r\n    return new WeekPriceRecord({\r\n      ...obj,\r\n      record: PriceRecord.sanitize(obj.record)\r\n    })\r\n  }\r\n\r\n}\r\n\r\nexport class PriceRecord implements IPriceRecord {\r\n  buyPrice: MaybePrice\r\n  prices: MaybePrice[]\r\n\r\n  constructor(obj: IPriceRecord = EmptyPriceRecord) {\r\n    this.buyPrice = obj.buyPrice\r\n    this.prices = [...obj.prices]\r\n  }\r\n  static sanitize(obj: any): PriceRecord {\r\n    if (!NullableNumberValidator.validate(obj.buyPrice)) {\r\n      throw new TypeError(\"buyPrice is not a number\")\r\n    }\r\n\r\n    const prices: (number | null)[] = (obj.prices ?? []).map((p: any) => {\r\n      if (!NullableNumberValidator.validate(p)) {\r\n        throw new TypeError(`Invalid price: ${p}`)\r\n      }\r\n      return p\r\n    })\r\n    return new PriceRecord({\r\n      ...obj,\r\n      prices,\r\n    })\r\n  }\r\n}\r\n","export function decreasingMatcher(prices: number[]): number {\r\n  return findIncreasingIndex(prices) === undefined ? 1.0 : 0\r\n}\r\n\r\nfunction findIncreasingIndex(prices: number[]): number | undefined {\r\n  const found = prices.slice(1).find((val, index) => prices[index] <= val)\r\n  if (found !== undefined) {\r\n    return found + 1\r\n  }\r\n  return undefined\r\n}\r\n","import { Behavior, Pattern, MaybePrice } from 'models'\r\nimport { decreasingMatcher } from './matchers'\r\n\r\nexport function analyze(prices: MaybePrice[]): Behavior {\r\n  const isDecreasing = decreasingMatcher(prices.filter((p): p is number => p !== null))\r\n\r\n  const pattern = isDecreasing ? Pattern.Decreasing : Pattern.Unknown\r\n\r\n  return {\r\n    pattern,\r\n    recommendation: getRecommendation(pattern),\r\n  }\r\n}\r\n\r\n\r\nfunction getRecommendation(pattern: Pattern): string {\r\n  switch(pattern) {\r\n    case Pattern.Decreasing:\r\n      return \"You should sell. Prices are unlikely to rise.\"\r\n    default: \r\n      return \"We have no idea what's going on.\"\r\n  }\r\n}\r\n","import dayjs from 'dayjs'\r\nimport React from 'react'\r\nimport { useSelector } from 'react-redux'\r\n\r\nimport { RootState } from 'redux/reducers'\r\nimport { analyze } from 'PriceAnalyzer/analyzer'\r\nimport { keyFromDayjs } from 'utils/time'\r\n\r\nfunction Component() {\r\n  // TODO: read this from application state\r\n  const key = keyFromDayjs(dayjs())\r\n  const weekPrices = useSelector((state: RootState) => state.weeklyPrices.prices)[key]?.record.prices ?? []\r\n\r\n  const behavior = analyze(weekPrices)\r\n\r\n  return <div>{behavior.recommendation}</div>\r\n}\r\n\r\nexport default Component\r\n","// Stolen from https://codesandbox.io/s/strongly-typed-form-values-with-react-final-form-26jkd\r\n\r\nimport React from \"react\";\r\nimport { FieldRenderProps } from \"react-final-form\";\r\n\r\ntype Props = FieldRenderProps<number, HTMLInputElement>\r\n\r\nfunction NumberInput(Component?: React.FC<any>): React.FC<any> | \"input\" {\r\n  return (props: Props) => {\r\n    const { input, meta, ...rest } = props;\r\n    if (Component !== undefined) {\r\n      return <Component {...input} {...rest} type=\"number\" />\r\n    }\r\n    return <input {...input} {...rest} type=\"number\"/>\r\n  }\r\n}\r\n\r\nexport default NumberInput;\r\n","import React from 'react'\r\nimport _ from 'lodash'\r\nimport { Form, Field } from 'react-final-form'\r\nimport styled from 'styled-components'\r\n\r\nimport NumberInput from 'components/NumberInput'\r\nimport { IPriceRecord } from 'models'\r\nimport { daysOfWeek } from 'utils/time'\r\n\r\nconst SubmitButton = styled.button`\r\ngrid-area: s;\r\n\r\nalign-self: end;\r\njustify-self: end;\r\ntransform: translate(25px, 10px);\r\n\r\n`\r\n\r\nenum TimeOfDay {\r\n  am = \"am\",\r\n  pm = \"pm\",\r\n}\r\n\r\nconst TimeLabel = styled.div<{ time: TimeOfDay }>`\r\ntext-transform: uppercase;\r\ngrid-area: ${props => `${props.time}`};\r\n`\r\n\r\nconst DayLabel = styled.div<{ index: number }>`\r\ngrid-area: ${props => `d${props.index}`};\r\n`\r\n\r\nconst FormInput = styled.input<{ index: number }>`\r\ngrid-area: ${({ index }) => {\r\n    const day = Math.floor(index / 2)\r\n    const timeOfDay = index % 2 === 0 ? \"a\" : \"p\"\r\n    return `d${day}${timeOfDay}`\r\n  }};\r\n`\r\n\r\nconst BuyPriceLabel = styled.label`\r\ngrid-area: bl;\r\n`\r\n\r\nconst BuyPriceInput = styled.input`\r\ngrid-area: bp;\r\n`\r\n\r\nconst StyledForm = styled.form`\r\ndisplay: grid;\r\ngrid-gap: 10px;\r\npadding: 10px;\r\nmargin: auto;\r\njustify-items: center;\r\nalign-items: center;\r\n\r\n${FormInput}, ${BuyPriceInput} {\r\n  width: calc(100% - 20px);\r\n  padding: 10px;\r\n  text-align: center;\r\n}\r\n\r\n${BuyPriceLabel} {\r\n  text-align: center;\r\n}\r\n\r\n@media only screen and (min-width: 800px) {\r\n  max-width: 600px;\r\n  grid-template-columns: 50px repeat(6, 1fr);\r\n  grid-template-rows: 1fr 50px repeat(4, 1fr);\r\n  grid-template-areas:\r\n    \".  .   .   bl  bl  .   .\"\t\r\n    \".  .   .   bp  bp  .   .\"\t\r\n    \".  d0  d1  d2  d3  d4  d5\"\r\n    \"am d0a d1a d2a d3a d4a d5a\"\r\n    \"pm d0p d1p d2p d3p d4p d5p\"\r\n    \".  .   .   .   .   .   s\";\r\n\r\n  ${BuyPriceInput} {\r\n    width: calc(60% - 20px);\r\n    align-self: start;\r\n  }\r\n}\r\n\r\n@media only screen and (max-width: 799px) {\r\n  max-width: 350px;\r\n  grid-template-columns: 24% repeat(4, 1fr);\r\n  padding-left: 10px;\r\n  padding-right: 40px;\r\n\r\n  grid-template-rows: auto;\r\n  grid-template-areas:\r\n    \"bl bl bp  bp bp\"\r\n    \".  am am  pm pm\"\r\n    \"d0 d0a d0a d0p d0p\"\r\n    \"d1 d1a d1a d1p d1p\"\r\n    \"d2 d2a d2a d2p d2p\"\r\n    \"d3 d3a d3a d3p d3p\"\r\n    \"d4 d4a d4a d4p d4p\"\r\n    \"d5 d5a d5a d5p d5p\"\r\n    \".  .   s   s   s\";\r\n  \r\n  ${DayLabel}, ${BuyPriceLabel} {\r\n    text-align: right;\r\n    place-self: center end;\r\n    padding-right: 10px;\r\n  }\r\n\r\n  ${BuyPriceLabel} {\r\n    place-self: center;\r\n  }\r\n\r\n  ${BuyPriceLabel}, ${BuyPriceInput} {\r\n    margin-bottom: 20px;\r\n  }\r\n}\r\n`\r\n\r\ntype UserInput = string | null\r\n\r\nexport interface FormValues {\r\n  buyPrice: UserInput,\r\n  // fields for each price entry, i.e. price-0\r\n  [key: string]: UserInput,\r\n}\r\n\r\nexport function transformValues(values: FormValues): IPriceRecord {\r\n  const pricePrefix = \"price-\"\r\n  const { ...props } = values\r\n  const buyPrice = (values.buyPrice !== null) ? (parseInt(values.buyPrice, 10) ?? null) : null\r\n  const rawPrices =\r\n    _.chain(props)\r\n      .pickBy((v, k) => k.startsWith(pricePrefix))\r\n      .mapKeys((v, k) => parseInt(k.slice(pricePrefix.length), 10))\r\n      .pickBy((v): v is string => v !== undefined)\r\n      .mapValues(v => (v !== null) ? parseInt(v, 10) : null)\r\n      .value()\r\n\r\n  const prices = Array.from(new Array(submittableDays.length * 2)).map((v, k) => rawPrices[k])\r\n  return {\r\n    buyPrice,\r\n    prices,\r\n  }\r\n}\r\n\r\ninterface Props {\r\n  onSubmit: (v: IPriceRecord) => any,\r\n  priceRecord: IPriceRecord,\r\n}\r\n\r\nfunction isNotDefined<T>(v: T | undefined): v is T {\r\n  return v !== undefined\r\n}\r\n\r\nconst timeOfDay = [TimeOfDay.am, TimeOfDay.pm]\r\n\r\nconst submittableDays = daysOfWeek.slice(1)\r\nconst am = submittableDays.map(d => `${d} AM`)\r\nconst pm = submittableDays.map(d => `${d} PM`)\r\nconst times: string[] =\r\n  _.chain(am)\r\n    .zip(pm)\r\n    .flatten()\r\n    .filter(isNotDefined)\r\n    .value()\r\n\r\n// NumberInput returns a new instance everytime, so keep the FC around so the reconciliator doesn't get confused\r\nconst BuyPriceInputComponent = NumberInput(BuyPriceInput)\r\nconst InputComponent = NumberInput(FormInput)\r\nconst Component = (props: Props) => (\r\n  <Form\r\n    onSubmit={(v: FormValues) => props.onSubmit(transformValues(v))}\r\n    render={({ handleSubmit }) => (\r\n      <StyledForm onSubmit={handleSubmit}>\r\n        <BuyPriceLabel htmlFor=\"buyPrice\">Buy Price</BuyPriceLabel>\r\n        <Field\r\n          name=\"buyPrice\"\r\n          initialValue={props.priceRecord.buyPrice ?? undefined}\r\n          component={BuyPriceInputComponent}\r\n        />\r\n        {timeOfDay.map((time) => (\r\n          <TimeLabel key={time} time={time}>{time}</TimeLabel>\r\n        ))}\r\n        {submittableDays.map((day, index) => (\r\n          <DayLabel key={index} index={index}>{day.slice(0, 3)}</DayLabel>\r\n        ))}\r\n        {times.map((time, index) => (\r\n          <Field\r\n            name={`price-${index}`}\r\n            component={InputComponent}\r\n            key={index}\r\n            index={index}\r\n            aria-label={time}\r\n            initialValue={props.priceRecord.prices[index]}\r\n          />\r\n        ))}\r\n        <SubmitButton type=\"submit\">Submit</SubmitButton>\r\n      </StyledForm>\r\n    )}\r\n  />\r\n)\r\n\r\nexport default Component\r\n","import Chart, { Point } from 'chart.js'\r\nimport React from 'react'\r\nimport styled from 'styled-components'\r\n\r\nconst Container = styled.div`\r\ndisplay: relative;\r\nbackground: #F7F0DE;\r\npadding: 20px;\r\nmargin: 40px;\r\nborder-radius: 20px;\r\n`\r\n\r\nexport interface Domain {\r\n  min: number,\r\n  max: number,\r\n}\r\n\r\ntype Props = {\r\n  label: string,\r\n  dataset: Point[],\r\n  domain: Domain,\r\n  convertLabel: (n: number) => string,\r\n}\r\ntype State = {}\r\n\r\nconst canvasProps = {\r\n  width: 800,\r\n  height: 200,\r\n}\r\n\r\nclass Graph extends React.Component<Props, State> {\r\n  canvas: React.RefObject<HTMLCanvasElement>\r\n  chart?: Chart\r\n\r\n  constructor(props: Props) {\r\n    super(props)\r\n    this.canvas = React.createRef()\r\n    this.chart = undefined\r\n  }\r\n  componentDidMount() {\r\n    this.renderChart()\r\n  }\r\n\r\n  componentDidUpdate() {\r\n    this.renderChart()\r\n  }\r\n\r\n  renderChart() {\r\n    var ctx = this.canvas.current?.getContext(\"2d\") ?? null\r\n    if (ctx === null) {\r\n      return\r\n    }\r\n    const labels = this.props.dataset.map(d => d.x)\r\n    const data = this.props.dataset\r\n    this.chart = new Chart(ctx, {\r\n      type: \"bar\",\r\n      data: {\r\n          labels,\r\n          datasets: [\r\n            {\r\n              label: this.props.label,\r\n              backgroundColor: 'rgb(255, 99, 132)',\r\n              borderColor: 'rgb(255, 99, 132)',\r\n              data,\r\n            },\r\n          ]\r\n      },\r\n      options: {\r\n        legend: {\r\n          display: false,\r\n        },\r\n        scales: {\r\n          xAxes: [{\r\n            ticks: {\r\n              callback: (value: number) => this.props.convertLabel(value),\r\n            }\r\n          }],\r\n          yAxes: [{\r\n            ticks: {\r\n              beginAtZero: true,\r\n            }\r\n          }]\r\n        },\r\n        tooltips: {\r\n          callbacks: {\r\n            title: item => {\r\n              const index = item[0]?.index\r\n              if (index === undefined) {\r\n                return \"\"\r\n              }\r\n              return this.props.convertLabel(index)\r\n            },\r\n          }\r\n        }\r\n      }\r\n    })\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <Container>\r\n        <canvas ref={this.canvas} {...canvasProps} />\r\n      </Container>\r\n    )\r\n  }  \r\n}\r\n\r\nexport default Graph\r\n","import React from 'react'\r\nimport { Point } from 'chart.js'\r\n\r\nimport Graph, { } from 'components/Graph'\r\nimport { submittableDays } from 'utils/time'\r\nimport { IPriceRecord } from 'models'\r\n\r\nfunction domainToLabel(x: number): string {\r\n  const day = submittableDays[(Math.floor(x / 2))]\r\n  const timeOfDay = x % 2 === 0 ? \"AM\" : \"PM\"\r\n  return `${day} ${timeOfDay}`\r\n}\r\n\r\nconst domain = {\r\n  min: 0,\r\n  max: 14,\r\n}\r\n\r\nfunction toDataset(prices: (number | null)[]): Point[] {\r\n  return prices.map((v, k) => ({\r\n    x: k,\r\n    y: v,\r\n  })).filter((v): v is Point => v !== null)\r\n}\r\n\r\ninterface WeekPriceHistoryGraphProps {\r\n  priceRecord: IPriceRecord\r\n}\r\n\r\nfunction Component(props: WeekPriceHistoryGraphProps) {\r\n  return (\r\n    <div>\r\n      <Graph\r\n        label=\"Price\"\r\n        domain={domain}\r\n        convertLabel={domainToLabel}\r\n        dataset={toDataset(props.priceRecord.prices)}\r\n      />\r\n    </div>\r\n  )\r\n}\r\n\r\nexport default Component\r\n","import { IWeekPriceRecord } from 'models'\r\n\r\nexport enum WeeklyActionType {\r\n  SAVE_WEEKLY_PRICES = \"SaveWeeklyPrices\",\r\n  LOAD_WEEKLY_PRICES = \"LoadWeeklyPrices\",\r\n}\r\n\r\nexport interface SaveWeeklyPrices {\r\n  type: typeof WeeklyActionType.SAVE_WEEKLY_PRICES,\r\n  payload: IWeekPriceRecord,\r\n}\r\n\r\nexport interface LoadWeeklyPrices {\r\n  type: typeof WeeklyActionType.LOAD_WEEKLY_PRICES,\r\n  payload: IWeekPriceRecord[],\r\n}\r\n\r\nexport type WeeklyActionTypes = LoadWeeklyPrices | SaveWeeklyPrices\r\n\r\nexport const SaveWeeklyPrices = (r: IWeekPriceRecord): SaveWeeklyPrices => ({\r\n  type: WeeklyActionType.SAVE_WEEKLY_PRICES,\r\n  payload: r,\r\n})\r\n\r\nexport const LoadWeeklyPrices = (records: IWeekPriceRecord[]): LoadWeeklyPrices => ({\r\n  type: WeeklyActionType.LOAD_WEEKLY_PRICES,\r\n  payload: records,\r\n})\r\n","import React from 'react'\r\nimport { RouteComponentProps } from '@reach/router'\r\nimport styled from 'styled-components'\r\nimport dayjs from 'dayjs'\r\n\r\nimport PriceAnalyzer from './PriceAnalyzer'\r\nimport WeekPriceForm from './WeekPriceForm'\r\nimport WeekPriceHistoryGraph from './WeekPriceHistoryGraph'\r\nimport { useDispatch, useSelector } from 'react-redux'\r\nimport { SaveWeeklyPrices } from 'redux/actions'\r\nimport { RootState } from 'redux/reducers'\r\nimport { IPriceRecord, EmptyPriceRecord } from 'models'\r\nimport { keyFromDayjs, yearWeekFromDayjs } from 'utils/time'\r\n\r\nconst Container = styled.section`\r\npadding: 20px 0 50px 0;\r\n`\r\n\r\nfunction Component(props: RouteComponentProps) {\r\n  const dispatch = useDispatch()\r\n\r\n  const key = keyFromDayjs(dayjs())\r\n  const priceRecord = useSelector((state: RootState) => state.weeklyPrices.prices)[key]?.record ?? EmptyPriceRecord\r\n\r\n  function savePrices(record: IPriceRecord) {\r\n    const weekRecord = {\r\n      ...yearWeekFromDayjs(dayjs()),\r\n      record,\r\n    }\r\n    dispatch(SaveWeeklyPrices(weekRecord))\r\n  }\r\n\r\n  return (\r\n    <Container>\r\n      <WeekPriceForm onSubmit={savePrices} priceRecord={priceRecord} />\r\n      <WeekPriceHistoryGraph priceRecord={priceRecord} />\r\n      <PriceAnalyzer />\r\n    </Container>\r\n  )\r\n}\r\n\r\nexport default Component\r\n","import React from 'react'\r\nimport { RouteComponentProps } from '@reach/router'\r\nimport styled from 'styled-components'\r\n\r\nimport WeekPriceHistoryGraph from './WeekPriceHistoryGraph'\r\nimport { useSelector } from 'react-redux'\r\nimport { RootState } from 'redux/reducers'\r\nimport { EmptyPriceRecord } from 'models'\r\n\r\nconst Container = styled.section`\r\npadding: 20px 0 50px 0;\r\n`\r\n\r\ninterface RouteProps extends RouteComponentProps {\r\n  year?: number,\r\n  week?: number,\r\n}\r\n\r\nfunction Component(props: RouteProps) {\r\n  const { year, week } = props\r\n  const key = `${year}-${week}`\r\n  const priceRecord = useSelector((state: RootState) => state.weeklyPrices.prices)[key]?.record ?? EmptyPriceRecord\r\n\r\n  return (\r\n    <Container>\r\n      <WeekPriceHistoryGraph priceRecord={priceRecord} />\r\n    </Container>\r\n  )\r\n}\r\n\r\nexport default Component\r\n","import React, { ButtonHTMLAttributes } from 'react'\r\nimport styled from 'styled-components'\r\n\r\nconst FloatContainer = styled.div`\r\nposition: relative;\r\n`\r\n\r\nconst FloatNav = styled.ul`\r\nposition: absolute;\r\nz-index: 1;\r\npadding: 0;\r\nleft: 0;\r\ntop: 100%;\r\nright: auto;\r\nwidth: max-content;\r\n\r\nmargin: 0;\r\ndisplay: none;\r\nlist-style: none;\r\n\r\n&.active {\r\n  display: grid;\r\n  grid-rows: auto;\r\n  grid-columns: 1fr;\r\n}\r\n\r\na {\r\n  display: block;\r\n}\r\n`\r\n\r\ninterface DropdownProps {\r\n  button: (p: ButtonHTMLAttributes<HTMLButtonElement>) => JSX.Element,\r\n  children: any,\r\n}\r\nexport default class Dropdown extends React.Component<DropdownProps> {\r\n  state: {\r\n    active: boolean\r\n  }\r\n  constructor(props: DropdownProps) {\r\n    super(props)\r\n    this.state = {\r\n      active: false\r\n    }\r\n  }\r\n\r\n  render() {\r\n    const toggleActive = () => {\r\n      this.setState({ active: !this.state.active })\r\n    }\r\n    return (\r\n      <FloatContainer>\r\n        {this.props.button({\r\n          onClick: toggleActive,\r\n          \"aria-haspopup\": \"true\",\r\n          \"aria-expanded\": this.state.active,\r\n        })}\r\n        <FloatNav className={`${this.state.active ? \"active\" : \"\"}`}>\r\n          {this.props.children}\r\n        </FloatNav>\r\n      </FloatContainer>\r\n    )\r\n  }\r\n}\r\n","import _ from 'lodash'\r\nimport styled from 'styled-components'\r\nimport React from 'react'\r\nimport dayjs, { Dayjs } from 'dayjs'\r\nimport { Link } from '@reach/router'\r\nimport { RootState } from 'redux/reducers'\r\nimport { useSelector } from 'react-redux'\r\nimport Dropdown from 'components/Dropdown'\r\n\r\n// Only show this number of dates on the navbar.\r\nconst MAX_NAV_DATES = 6\r\n\r\nconst NavButton = styled.button``\r\n\r\nconst StyledNav = styled.nav`\r\ndisplay: flex;\r\nflex: 1 1 auto;\r\njustify-content: center;\r\n\r\nbutton, a {\r\n  font-family: Arial;\r\n  font-size: 15px;\r\n  display: block;\r\n  padding: 10px 15px;\r\n  border-radius: 10px;\r\n  text-decoration: none;\r\n  font-weight: 700;\r\n  margin: 5px;\r\n  border: 2px solid transparent;\r\n}\r\n\r\nbutton, a, a:visited {\r\n  color: #BCB5A3;\r\n  border: 2px solid #BCB5A3;\r\n  background: transparent;\r\n}\r\n\r\n\r\n${NavButton}:hover, a:hover {\r\n  background: #ffbc55;\r\n  border: 2px solid #fff6c9;\r\n  color: #614f2d;\r\n}\r\n\r\na.active {\r\n  color: #FFF6C9;\r\n  background: #F49809;\r\n  border: 2px solid transparent;\r\n}\r\n`\r\n\r\nfunction formatWeekDiff(start: Dayjs, now: Dayjs): string {\r\n  const weekDiff = Math.ceil(start.diff(now, 'week'))\r\n\r\n  if (weekDiff === 0) {\r\n    return 'This week'\r\n  }\r\n  if (weekDiff === 1) {\r\n    return 'Last week'\r\n  }\r\n  if (weekDiff < 5) {\r\n    return `${weekDiff} weeks ago`\r\n  }\r\n  return start.format(\"YYYY-MM-DD\")\r\n}\r\n\r\nconst NavLink = (props: any) => (\r\n  <Link\r\n    {...props}\r\n    getProps={({ isCurrent }) => ({\r\n      className: isCurrent ? \"active\" : \"\",\r\n    })}\r\n  />\r\n)\r\n\r\n\r\nexport default function Nav() {\r\n  const pricesByWeek = useSelector((state: RootState) => state.weeklyPrices.prices)\r\n  const sorted =\r\n    _.chain(pricesByWeek)\r\n      .values()\r\n      .sortBy(['year', 'week'])\r\n      .reverse()\r\n      // Arbitrary.\r\n      .slice(0, MAX_NAV_DATES)\r\n      .value()\r\n\r\n  const now = dayjs()\r\n\r\n  return (\r\n    <StyledNav>\r\n      <NavLink to=\"\">Home</NavLink>\r\n      <NavLink to=\"price/me\">My Prices</NavLink>\r\n      <Dropdown\r\n        button={props => <NavButton {...props}>Past Prices</NavButton>}\r\n      >\r\n        {sorted.map(r => {\r\n          const start = dayjs().isoWeek(r.week).year(r.year)\r\n\r\n          return (\r\n            <li key={start.valueOf()}>\r\n              <NavLink to={`price/me/${r.year}/${r.week}`}>\r\n                {formatWeekDiff(start, now)}\r\n              </NavLink>\r\n            </li>\r\n          )\r\n        })}\r\n      </Dropdown>\r\n    </StyledNav>\r\n  )\r\n}\r\n","import React, { ReactNode } from 'react'\r\nimport styled from 'styled-components'\r\nimport { Router, RouteComponentProps } from '@reach/router'\r\n\r\nimport logo from './logo.png'\r\nimport './App.css'\r\nimport EditPrice from 'views/EditPrice'\r\nimport ViewPrice from './views/ViewPrice'\r\nimport Nav from './views/Nav'\r\n\r\nconst StyledHeader = styled.header`\r\ndisplay: flex;\r\nalign-items: center;\r\npadding: 20px;\r\n`\r\n\r\n\r\nconst StyledImg = styled.img`\r\nobject-fit: contain;\r\nmax-width: 10vw;\r\n`\r\n\r\nfunction Header() {\r\n  return (\r\n    <StyledHeader>\r\n      <StyledImg src={logo} alt=\"logo\" />\r\n      <Nav />\r\n    </StyledHeader>\r\n  )\r\n}\r\n\r\nfunction Home(props: RouteComponentProps) {\r\n  return <div />\r\n}\r\n\r\ninterface InAppProps extends RouteComponentProps {\r\n  children: ReactNode\r\n}\r\n\r\nfunction InApp(props: InAppProps) {\r\n  return (\r\n    <div className=\"App\">\r\n      <Header />\r\n      {props.children}\r\n    </div>\r\n  )\r\n}\r\n\r\nfunction App() {\r\n  return (\r\n    <Router basepath=\"turnipwatch\">\r\n      <InApp path=\"/\">\r\n        <EditPrice path=\"price/me\" />\r\n        <ViewPrice path=\"price/me/:year/:week\" />\r\n        <Home path=\"turnipwatch\" />\r\n      </InApp>\r\n    </Router>\r\n\r\n  )\r\n}\r\n\r\nexport default App\r\n","// This optional code is used to register a service worker.\r\n// register() is not called by default.\r\n\r\n// This lets the app load faster on subsequent visits in production, and gives\r\n// it offline capabilities. However, it also means that developers (and users)\r\n// will only see deployed updates on subsequent visits to a page, after all the\r\n// existing tabs open on the page have been closed, since previously cached\r\n// resources are updated in the background.\r\n\r\n// To learn more about the benefits of this model and instructions on how to\r\n// opt-in, read https://bit.ly/CRA-PWA\r\n\r\nconst isLocalhost = Boolean(\r\n  window.location.hostname === 'localhost' ||\r\n    // [::1] is the IPv6 localhost address.\r\n    window.location.hostname === '[::1]' ||\r\n    // 127.0.0.0/8 are considered localhost for IPv4.\r\n    window.location.hostname.match(\r\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\r\n    )\r\n);\r\n\r\ntype Config = {\r\n  onSuccess?: (registration: ServiceWorkerRegistration) => void;\r\n  onUpdate?: (registration: ServiceWorkerRegistration) => void;\r\n};\r\n\r\nexport function register(config?: Config) {\r\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\r\n    // The URL constructor is available in all browsers that support SW.\r\n    const publicUrl = new URL(\r\n      process.env.PUBLIC_URL,\r\n      window.location.href\r\n    );\r\n    if (publicUrl.origin !== window.location.origin) {\r\n      // Our service worker won't work if PUBLIC_URL is on a different origin\r\n      // from what our page is served on. This might happen if a CDN is used to\r\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\r\n      return;\r\n    }\r\n\r\n    window.addEventListener('load', () => {\r\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\r\n\r\n      if (isLocalhost) {\r\n        // This is running on localhost. Let's check if a service worker still exists or not.\r\n        checkValidServiceWorker(swUrl, config);\r\n\r\n        // Add some additional logging to localhost, pointing developers to the\r\n        // service worker/PWA documentation.\r\n        navigator.serviceWorker.ready.then(() => {\r\n          console.log(\r\n            'This web app is being served cache-first by a service ' +\r\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\r\n          );\r\n        });\r\n      } else {\r\n        // Is not localhost. Just register service worker\r\n        registerValidSW(swUrl, config);\r\n      }\r\n    });\r\n  }\r\n}\r\n\r\nfunction registerValidSW(swUrl: string, config?: Config) {\r\n  navigator.serviceWorker\r\n    .register(swUrl)\r\n    .then(registration => {\r\n      registration.onupdatefound = () => {\r\n        const installingWorker = registration.installing;\r\n        if (installingWorker == null) {\r\n          return;\r\n        }\r\n        installingWorker.onstatechange = () => {\r\n          if (installingWorker.state === 'installed') {\r\n            if (navigator.serviceWorker.controller) {\r\n              // At this point, the updated precached content has been fetched,\r\n              // but the previous service worker will still serve the older\r\n              // content until all client tabs are closed.\r\n              console.log(\r\n                'New content is available and will be used when all ' +\r\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\r\n              );\r\n\r\n              // Execute callback\r\n              if (config && config.onUpdate) {\r\n                config.onUpdate(registration);\r\n              }\r\n            } else {\r\n              // At this point, everything has been precached.\r\n              // It's the perfect time to display a\r\n              // \"Content is cached for offline use.\" message.\r\n              console.log('Content is cached for offline use.');\r\n\r\n              // Execute callback\r\n              if (config && config.onSuccess) {\r\n                config.onSuccess(registration);\r\n              }\r\n            }\r\n          }\r\n        };\r\n      };\r\n    })\r\n    .catch(error => {\r\n      console.error('Error during service worker registration:', error);\r\n    });\r\n}\r\n\r\nfunction checkValidServiceWorker(swUrl: string, config?: Config) {\r\n  // Check if the service worker can be found. If it can't reload the page.\r\n  fetch(swUrl, {\r\n    headers: { 'Service-Worker': 'script' }\r\n  })\r\n    .then(response => {\r\n      // Ensure service worker exists, and that we really are getting a JS file.\r\n      const contentType = response.headers.get('content-type');\r\n      if (\r\n        response.status === 404 ||\r\n        (contentType != null && contentType.indexOf('javascript') === -1)\r\n      ) {\r\n        // No service worker found. Probably a different app. Reload the page.\r\n        navigator.serviceWorker.ready.then(registration => {\r\n          registration.unregister().then(() => {\r\n            window.location.reload();\r\n          });\r\n        });\r\n      } else {\r\n        // Service worker found. Proceed as normal.\r\n        registerValidSW(swUrl, config);\r\n      }\r\n    })\r\n    .catch(() => {\r\n      console.log(\r\n        'No internet connection found. App is running in offline mode.'\r\n      );\r\n    });\r\n}\r\n\r\nexport function unregister() {\r\n  if ('serviceWorker' in navigator) {\r\n    navigator.serviceWorker.ready\r\n      .then(registration => {\r\n        registration.unregister();\r\n      })\r\n      .catch(error => {\r\n        console.error(error.message);\r\n      });\r\n  }\r\n}\r\n","import { combineReducers } from \"redux\"\r\nimport _ from 'lodash'\r\n\r\nimport {\r\n  WeeklyActionTypes,\r\n  WeeklyActionType,\r\n} from './actions'\r\nimport { IWeekPriceRecord } from 'models'\r\n\r\nexport interface WeeklyState {\r\n  prices: { [k: string]: IWeekPriceRecord },\r\n}\r\n\r\nconst initialWeeklyState = {\r\n  prices: {},\r\n}\r\n\r\nfunction getKey(r: IWeekPriceRecord) {\r\n  return `${r.year}-${r.week}`\r\n}\r\n\r\nexport function weeklyPriceReducer(\r\n  state: WeeklyState = initialWeeklyState,\r\n  action: WeeklyActionTypes,\r\n): WeeklyState {\r\n  switch (action.type) {\r\n    case WeeklyActionType.LOAD_WEEKLY_PRICES:\r\n      return {\r\n        ...state,\r\n        prices: _.keyBy(action.payload, getKey),\r\n      }\r\n    case WeeklyActionType.SAVE_WEEKLY_PRICES:\r\n      return {\r\n        ...state,\r\n        prices: {\r\n          ...state.prices,\r\n          [getKey(action.payload)]: action.payload\r\n        },\r\n      }\r\n    default:\r\n      return state\r\n  }\r\n}\r\n\r\nexport const rootReducer = combineReducers({\r\n  weeklyPrices: weeklyPriceReducer,\r\n})\r\n\r\nexport type RootState = ReturnType<typeof rootReducer>\r\n","import { IPriceStore } from './types'\r\nimport { IWeekPriceRecord, WeekPriceRecord } from 'models'\r\n\r\nconst indexKey = \"prices-index\"\r\n\r\n\r\nfunction stringToModel(raw: string): IWeekPriceRecord | null {\r\n  let parsed: string | null = null\r\n  try {\r\n    parsed = JSON.parse(raw)\r\n  } catch (e) {\r\n    console.warn(`Stored price is not valid json: ${raw}`)\r\n    return null\r\n  }\r\n\r\n  try {\r\n    return WeekPriceRecord.sanitize(parsed)\r\n  } catch (e) {\r\n    console.warn(`Error deserializing stored price: ${parsed}`)\r\n    return null\r\n  }\r\n}\r\n\r\nfunction recordKey(year: number, week: number): string {\r\n  const weekRaw = `0${week}`\r\n  const weekStr = weekRaw.substr(weekRaw.length - 2)\r\n  return `prices-${year}-${weekStr}`\r\n}\r\n\r\nexport default function LocalStorageApi(backing = window.localStorage): IPriceStore {\r\n  function readIndex(): Set<string> {\r\n    const indexRaw = backing.getItem(indexKey)\r\n    let index: any | null\r\n    try {\r\n      index = (indexRaw === null) ? [] : JSON.parse(indexRaw)\r\n    } catch (e) {\r\n      console.warn(`Index is not valid json: ${indexRaw}`)\r\n      return new Set()\r\n    }\r\n\r\n    if (!(index instanceof Array)) {\r\n      console.warn(\"Index corrupted\")\r\n      return new Set()\r\n    }\r\n    return new Set(index.map(i => i.toString()))\r\n  }\r\n  function writeIndex(keys: Set<string>) {\r\n    backing.setItem(indexKey, JSON.stringify(Array.from(keys)))\r\n  }\r\n  return {\r\n    save(r: IWeekPriceRecord) {\r\n      return new Promise((res) => {\r\n        const index = readIndex()\r\n        const key = recordKey(r.year, r.week)\r\n        const payload = JSON.stringify(r)\r\n        backing.setItem(key, payload)\r\n        console.log(\"Saved to storage\")\r\n        writeIndex(index.add(key))\r\n        console.log(\"Updated index\")\r\n        res(undefined)\r\n      })\r\n    },\r\n    get(year: number, month: number) {\r\n      return new Promise((res) => {\r\n        const key = recordKey(year, month)\r\n        const raw = backing.getItem(key)\r\n        if (raw === null) {\r\n          return undefined\r\n        }\r\n        const payload = JSON.parse(raw)\r\n        res(payload)\r\n      })\r\n    },\r\n    list() {\r\n      return new Promise((res, rej) => {\r\n        let index = readIndex()\r\n        const deserialized =\r\n          Array.from(index.values())\r\n            .map(k => backing.getItem(k))\r\n            .filter((v): v is string => v !== null)\r\n            .map(stringToModel)\r\n            .filter((v): v is IWeekPriceRecord => v !== null)\r\n        res(deserialized)\r\n      })\r\n    }\r\n  }\r\n}\r\n","import { put, takeEvery, all } from 'redux-saga/effects'\r\nimport { LoadWeeklyPrices, WeeklyActionType, SaveWeeklyPrices } from 'redux/actions';\r\nimport LocalStorageWeeklyPrices from './PriceStore/localstorage';\r\n\r\nconst priceStore = LocalStorageWeeklyPrices()\r\n\r\nexport function* loadWeeklyPrices() {\r\n  const items = yield priceStore.list()\r\n  yield put(LoadWeeklyPrices(items))\r\n}\r\n\r\nexport function* watchSaveWeeklyPrices() {\r\n  yield takeEvery(WeeklyActionType.SAVE_WEEKLY_PRICES, function*(action: SaveWeeklyPrices) {\r\n    yield priceStore.save(action.payload)\r\n  })\r\n}\r\n\r\nexport default function* rootSaga() {\r\n  yield all([\r\n    loadWeeklyPrices(),\r\n    watchSaveWeeklyPrices(),\r\n  ])\r\n}\r\n","import React from 'react'\r\nimport ReactDOM from 'react-dom'\r\nimport { Provider } from 'react-redux'\r\nimport { createStore, applyMiddleware } from 'redux'\r\nimport createSagaMiddleware from 'redux-saga'\r\nimport { composeWithDevTools } from 'redux-devtools-extension'\r\nimport dayjs from 'dayjs'\r\nimport isoWeek from 'dayjs/plugin/isoWeek'\r\n\r\nimport App from './App'\r\nimport * as serviceWorker from './serviceWorker'\r\nimport { rootReducer } from \"./redux/reducers\"\r\n\r\nimport './index.css'\r\nimport rootSaga from './sagas'\r\n\r\ndayjs.extend(isoWeek)\r\n\r\nconst composeEnhancers = composeWithDevTools({})\r\nconst sagaMiddleware = createSagaMiddleware()\r\nconst store = createStore(\r\n  rootReducer,\r\n  composeEnhancers(applyMiddleware(sagaMiddleware)),\r\n)\r\n\r\nsagaMiddleware.run(rootSaga)\r\n\r\nReactDOM.render(\r\n  <React.StrictMode>\r\n    <Provider store={store}>\r\n      <App />\r\n    </Provider>\r\n  </React.StrictMode>,\r\n  document.getElementById('root')\r\n)\r\n\r\n// If you want your app to work offline and load faster, you can change\r\n// unregister() to register() below. Note this comes with some pitfalls.\r\n// Learn more about service workers: https://bit.ly/CRA-PWA\r\nserviceWorker.unregister()\r\n"],"sourceRoot":""}